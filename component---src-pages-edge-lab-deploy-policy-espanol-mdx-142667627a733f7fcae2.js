(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{D6Qv:function(e,o,a){"use strict";a.r(o),a.d(o,"_frontmatter",(function(){return l})),a.d(o,"default",(function(){return b}));var n=a("vxd2"),i=a("+ZQ4"),t=(a("tbR7"),a("8ZXK")),r=a("ZUrL"),l=(a("GP0y"),{}),c=function(e){return function(o){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(t.b)("div",o)}},s=c("PageDescription"),p=c("InlineNotification"),d={_frontmatter:l},u=r.a;function b(e){var o=e.components,a=Object(i.a)(e,["components"]);return Object(t.b)(u,Object(n.a)({},d,a,{components:o,mdxType:"MDXLayout"}),Object(t.b)(s,{mdxType:"PageDescription"},Object(t.b)("p",null,"En esta sección desplegará el servicio de borde que creó en un paso anterior en su entorno de borde.")),Object(t.b)("h2",null,"Despliegue de un servicio de borde con una política de despliegue"),Object(t.b)("h3",null,"PCondiciones previas para desplegar su propio servicio"),Object(t.b)("p",null,"  Si aún no lo ha hecho, complete la sección ",Object(t.b)("a",Object(n.a)({parentName:"p"},{href:"../service/espanol"}),"Crear un servicio de borde")),Object(t.b)("h3",null,"Uso del servicio de borde con política de despliegue"),Object(t.b)("p",null,"El mecanismo de políticas de Horizonte ofrece una alternativa al uso de patronesde despliegue. Las políticas proporcionan un control mucho más fino sobre la ubicación del despliegue de los servicios de borde. También proporciona una mayor separación de preocupaciones, permitiendo a los propietarios de los Nodos Edge, a los desarrolladores del código del Servicio y a los propietarios de la Empresa articular independientemente sus propias Políticas. Por lo tanto, existen tres tipos de políticas Horizon:"),Object(t.b)("ol",null,Object(t.b)("li",{parentName:"ol"},Object(t.b)("p",{parentName:"li"},"Política de nodo (proporcionada en el momento del registro por el propietario del nodo)")),Object(t.b)("li",{parentName:"ol"},Object(t.b)("p",{parentName:"li"},"Política de Servicio (puede aplicarse a un Servicio publicado en la Bolsa)")),Object(t.b)("li",{parentName:"ol"},Object(t.b)("p",{parentName:"li"},"Política de despliegue (que corresponde aproximadamente a un patrón de despliegue)"))),Object(t.b)("h2",null,"Política de nodo"),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},"Como alternativa a la especificación de un Patrón de Despliegue al registrar su Nodo Edge, puede registrarse con una Política de Nodo.")),Object(t.b)("ol",null,Object(t.b)("li",{parentName:"ol"},"Obtenga el archivo de política de nodo helloworld requerido:")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),"wget https://raw.githubusercontent.com/open-horizon/examples/master/edge/services/helloworld/horizon/node.policy.json\n")),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},"Abajo está el archivo node.policy.json que obtuviste en el primer paso:")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),'{\n  "properties": [\n    { "name": "openhorizon.example", "value": "hello-$USER_ID" }\n  ],\n  "constraints": [\n  ]\n}\n')),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},"Proporciona valores para una sola propiedad (openhorizon.example), cambie el valor a ",Object(t.b)("strong",{parentName:"li"},"hello-$USER_ID")," esto debería restringir los servicios que se despliegan a este nodo de borde a su servicio hello.")),Object(t.b)("ol",{start:2},Object(t.b)("li",{parentName:"ol"},"Registre su política de nodo con esta política")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),"hzn register --policy node.policy.json\n")),Object(t.b)("ol",{start:3},Object(t.b)("li",{parentName:"ol"},"Cuando se complete el registro, utilice el siguiente comando para revisar la política de nodo:")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),"hzn policy list\n")),Object(t.b)(p,{kind:"info",mdxType:"InlineNotification"},Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"Observe")," que, además de las tres propiedades indicadas en el archivo node_policy.json, Horizon ha añadido algunas más (openhorizon.cpu, openhorizon.arch y openhorizon.memory). Horizon proporciona esta información adicional de forma automática y estas propiedades pueden utilizarse en cualquiera de sus restricciones de política.")),Object(t.b)("p",null,"Su dispositivo debería ser ahora también visible en ",Object(t.b)("strong",{parentName:"p"},"Active sin servicios")," en la interfaz de usuario de IBM Edge Application Manager\n",Object(t.b)("img",Object(n.a)({parentName:"p"},{src:"../images/IEAM-node-active.png",alt:"IEAM-node-active"}))),Object(t.b)("h2",null,"Política de servicio"),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},"Al igual que los otros dos tipos de Políticas, la Política de Servicio contiene un conjunto de propiedades y un conjunto de restricciones. Las propiedades de una Política de Servicio pueden indicar características del código del Servicio que los autores de la Política de Nodo o los autores de la Política de Despliegue pueden encontrar relevantes. Las restricciones de una Política de Servicio pueden utilizarse para restringir dónde puede ejecutarse este Servicio. El desarrollador del Servicio podría, por ejemplo, afirmar que este Servicio requiere una configuración de hardware particular como restricciones de CPU/GPU,\nrestricciones de memoria, sensores específicos, actuadores u otros dispositivos periféricos requeridos, etc."),Object(t.b)("li",{parentName:"ul"},"A continuación se muestra el archivo ",Object(t.b)("strong",{parentName:"li"},"service.policy.json")," que se creó como parte de la creación de su servicio en el directorio horizonte:")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),'{\n    "properties": [\n        {\n            "name": "prop1",\n            "value": "value1"\n        }\n    ],\n    "constraints": []\n}\n')),Object(t.b)("ol",null,Object(t.b)("li",{parentName:"ol"},"Vea la política de servicio publicada adjunta a su servicio:")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),"hzn exchange service listpolicy ${HZN_ORG_ID}/hello-${USER_ID}_0.0.1_$(hzn architecture)\n")),Object(t.b)(p,{kind:"info",mdxType:"InlineNotification"},Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"Tenga")," que Horizon ha vuelto a añadir automáticamente algunas propiedades adicionales a su política. Estos valores de propiedad generados pueden utilizarseen las restricciones de las políticas de nodo y las políticas de despliegue.")),Object(t.b)("ol",{start:2},Object(t.b)("li",{parentName:"ol"},"Cree un archivo ",Object(t.b)("strong",{parentName:"li"},"service.policy.json")," con el siguiente contenido")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),'{\n  "properties": [\n  ],\n  "constraints": [\n    "openhorizon.memory >= 100"\n  ]\n}\n')),Object(t.b)(p,{kind:"info",mdxType:"InlineNotification"},Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"Tenga")," en cuenta que esta simple Política de Servicio no proporciona ninguna propiedad, pero tiene una restricción. Esta restricción de ejemplo es una que un desarrollador de Servicios podría añadir, indicando que su Servicio sólo debe ejecutarse en nodos de borde con 100 MB o más de memoria.")),Object(t.b)(p,{kind:"info",mdxType:"InlineNotification"},Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"Tenga")," que Horizon ha vuelto a añadir automáticamente algunas propiedades adicionales a su política. Estos valores de propiedad generados pueden utilizarseen las restricciones de las políticas de nodo y las políticas de despliegue.")),Object(t.b)("ol",{start:3},Object(t.b)("li",{parentName:"ol"},"Actualice el service.policies adjunto a su servicio")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),"hzn exchange service addpolicy -f service.policy.json ${HZN_ORG_ID}/hello-${USER_ID}_0.0.1_$(hzn architecture)\n")),Object(t.b)("ol",{start:4},Object(t.b)("li",{parentName:"ol"},"Vea las actualizaciones publicadas de la política de servicio adjunta a su servicio:")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),"hzn exchange service listpolicy ${HZN_ORG_ID}/hello-${USER_ID}_0.0.1_$(hzn architecture)\n")),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},"Ahora que ha configurado la política para su nodo de borde y que la política de servicio publicada está en el intercambio, podemos pasar al paso final de definir una política de despliegue para unirlos todos y hacer que el software se despliegue automáticamente en su nodo de borde.")),Object(t.b)("h2",null,"Política de Despliegue"),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},"La Política de Despliegue es lo que une los Nodos Edge, los Servicios Publicadosy las Políticas definidas para cada uno de ellos, haciéndola más o menos análogaa los Patrones de Despliegue con los que has trabajado previamente."),Object(t.b)("li",{parentName:"ul"},"La Política de Despliegue, al igual que los otros dos tipos de Políticas, contiene un conjunto de propiedades y un conjunto de restricciones, pero también contiene otras cosas. Por ejemplo, identifica explícitamente el Servicio que hará que se despliegue en los Nodos Edge si la negociación tiene éxito, además de losvalores de las variables de configuración, realizando la función equivalente a la cláusula -f horizon/userinput.json de un comando hzn register … del Patrón de Despliegue. El enfoque de la Política de Despliegue para los valores de configuración es más potente porque esta operación se puede realizar de forma centralizada (no es necesario conectarse directamente al Edge Node).Deployment Policy, like the other two Policy types, contains a set of properties and a set of constraints, but it contains other things as well. For example, it explicitly identifies the Service it will cause to be deployed onto Edge Nodes if negotiation is successful, in addition to configuration variable values, performing the equivalent function to the -f horizon/userinput.json clause of a Deployment Pattern hzn register … command. The Deployment Policy approach for configuration values is more powerful because this operation can be performed centrally (no need to connect directly to the Edge Node).")),Object(t.b)("ol",null,Object(t.b)("li",{parentName:"ol"},"Cree un archivo ",Object(t.b)("strong",{parentName:"li"},"deployment.policy.json")," con el contenido siguiente para su servicio:")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),'{\n  "label": "$SERVICE_NAME Deployment Policy",\n  "description": "A super-simple sample Horizon Deployment Policy",\n  "service": {\n    "name": "$SERVICE_NAME",\n    "org": "$HZN_ORG_ID",\n    "arch": "*",\n    "serviceVersions": [\n      {\n        "version": "$SERVICE_VERSION",\n        "priority":{}\n      }\n    ]\n  },\n  "properties": [\n  ],\n  "constraints": [\n    "openhorizon.example == hello-$USER_ID"\n  ],\n  "userInput": [\n    {\n      "serviceOrgid": "$HZN_ORG_ID",\n      "serviceUrl": "$SERVICE_NAME",\n      "serviceVersionRange": "[0.0.0,INFINITY)",\n      "inputs": [\n        {\n          "name": "HW_WHO",\n          "value": "Valued Customer"\n        }\n      ]\n    }\n  ]\n}\n')),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},"Este sencillo ejemplo de Política de Despliegue no proporciona ninguna propiedad, pero tiene un valor de restricción que se satisface con las propiedades establecidas en el archivo node.policy.json, por lo que esta Política de Despliegue debería desplegar con éxito nuestro Servicio en el Nodo Edge."),Object(t.b)("li",{parentName:"ul"},"Al final, la sección userInput tiene el mismo propósito que los archivos horizon/userinput.json proporcionados para otros ejemplos si los servicios dados los requieren. En este caso, el servicio helloworld define sólo una variable de configuración, HW_WHO, y la sección userInput proporciona aquí un valor para HW_WHO (es decir, cliente valorado).")),Object(t.b)("ol",null,Object(t.b)("li",{parentName:"ol"},"Publique y vea su política de despliegue en Horizon Exchange:")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),"hzn exchange deployment addpolicy -f deployment.policy.json ${HZN_ORG_ID}/policy-hello-${USER_ID}_0.0.1\nhzn exchange deployment listpolicy ${HZN_ORG_ID}/policy-hello-${USER_ID}_0.0.1\n")),Object(t.b)("ol",{start:2},Object(t.b)("li",{parentName:"ol"},"En este momento su dispositivo de borde debería haber formado un acuerdo con uno de los bots de acuerdos de Horizon (esto suele tardar unos 15 segundos). Consulte repetidamente los acuerdos de este dispositivo hasta que se completen los campos agreement_finalized_time y agreement_execution_start_time:")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),"hzn agreement list\n")),Object(t.b)("ol",{start:3},Object(t.b)("li",{parentName:"ol"},"Una vez realizado el acuerdo, enumera el contenedor docker del servicio edge que se ha iniciado como resultado:")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),"sudo docker ps\n")),Object(t.b)("ol",{start:4},Object(t.b)("li",{parentName:"ol"},"Vea la salida del servicio ibm.helloworld:")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),"sudo hzn service log -f hello-$USER_ID\n")),Object(t.b)(p,{kind:"info",mdxType:"InlineNotification"},Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"Nota:")," Pulse Ctrl C para detener la salida del comando.")),Object(t.b)("p",null,"Vuelve a mirar en la interfaz de usuario de IBM Edge Application Manager, tu dispositivo debería mostrar el estado ",Object(t.b)("strong",{parentName:"p"},"Activo con servicios"),"\n",Object(t.b)("img",Object(n.a)({parentName:"p"},{src:"../images/IEAM-node-active-service.png",alt:"IEAM-node-active-service"}))),Object(t.b)("ol",{start:5},Object(t.b)("li",{parentName:"ol"},"Desregistre su nodo Edge:")),Object(t.b)("pre",null,Object(t.b)("code",Object(n.a)({parentName:"pre"},{}),"hzn unregister -f\n")))}b.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-edge-lab-deploy-policy-espanol-mdx-142667627a733f7fcae2.js.map